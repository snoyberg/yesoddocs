<!DOCTYPE html>
<html>
  <head>
    <title>Yesod Web Framework Screencasts</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/themes/cupertino/jquery-ui.css">
    <script>
      $(function(){
        $("#accordion").accordion({
          collapsible:true,
          autoHeight: false,
          active: false
        });
      });
    </script>
    <style>
      body {
        font-family: sans-serif;
        margin: 0;
        padding: 0;
      }
      h1 {
        text-align: center;
      }
      #accordion {
        width: 760px;
        margin: 0 auto;
      }
      #accordion div {
        height: 400px;
      }
      h3.ui-helper-reset {
        padding-left: 30px;
      }
      nav ul {
        list-style: none;
        padding: 5px 0 5px 30px;
        background: #eee url($root/static/logo-small.png) no-repeat 5px center;
        margin: 0;
        border-bottom: 1px solid #000;
      }
      nav li {
        display: inline;
        padding-right: 10px;
      }
      nav a, nav a:visited {
        color: #009;
        text-decoration: none;
      }
      nav a:hover {
        color: #909;
      }
    </style>
  </head>
  <body>
    <nav>
      <ul>
        <li><a href="$root">Homepage</a></li>
        <li><a href="$root/book/">Read the Book</a></li>
        <li>Watch the Screencasts</li>
        <li><a href="$root/examples/">See Some Code</a></li>
      </ul>
    </nav>
    <h1>Yesod Web Framework Screencasts</h1>
    <div id="accordion">
      <h3>Introduction to Yesod Web Framework 0.5</h3>
      <div>
        <iframe src="http://player.vimeo.com/video/14516222?portrait=0" width="480" height="384" frameborder="0"></iframe><p><a href="http://vimeo.com/14516222">Introduction to Yesod Web Framework 0.5</a> from <a href="http://vimeo.com/user1975429">Michael Snoyman</a> on <a href="http://vimeo.com">Vimeo</a>.</p>
      </div>
      <h3>Hello World</h3>
      <div>
<object width="480" height="385"><param name="movie" value="http://www.youtube.com/v/BEWJnDgrmp0&hl=en_US&fs=1&"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/BEWJnDgrmp0&hl=en_US&fs=1&" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="480" height="385"></embed></object>
      </div>
      <h3>Blog, part 1</h3>
      <div>
<iframe src="http://player.vimeo.com/video/13296597?portrait=0" width="480" height="320" frameborder="0"></iframe><p><a href="http://vimeo.com/13296597">Blog Tutorial - Part 1 - Yesod Web Framework 0.4.0</a> from <a href="http://vimeo.com/user1975429">Michael Snoyman</a> on <a href="http://vimeo.com">Vimeo</a>.</p>
<p>Here's the source code:</p>

<pre><code>{-# LANGUAGE TypeFamilies, QuasiQuotes, GeneralizedNewtypeDeriving #-}
    import Yesod
    import Database.Persist.Sqlite
    import Data.Time (Day)
    
    mkPersist [$persist|
    Entry
        title String
        day Day Desc
        content Html'
        deriving
    |]
    
    data Blog = Blog { pool :: Pool Connection }
    
    mkYesod "Blog" [$parseRoutes|
    / RootR GET
    /entry/#EntryId EntryR GET
    |]
    
    instance Yesod Blog where
        approot _ = "http://localhost:3000"
    
    instance YesodPersist Blog where
        type YesodDB Blog = SqliteReader
        runDB db = fmap pool getYesod&gt;&gt;= runSqlite db
    
    getRootR = do
        entries &lt;- runDB $ select [] [EntryDayDesc]
        applyLayoutW $ do
            setTitle $ string "Yesod Blog Tutorial Homepage"
            addBody [$hamlet|
    %h1 Archive
    %ul
        $forall entries entry
            %li
                %a!href=@EntryR.fst.entry@ $entryTitle.snd.entry$
    |]
    
    getEntryR entryid = do
        entry &lt;- runDB $ get404 entryid
        applyLayoutW $ do
            setTitle $ string $ entryTitle entry
            addBody [$hamlet|
    %h1 $entryTitle.entry$
    %h2 $show.entryDay.entry$
    $entryContent.entry$
    |]
    
    withBlog f = withSqlite "blog.db3" 8 $ \pool -&gt; do
        flip runSqlite pool $ initialize (undefined :: Entry)
        f $ Blog pool
    
    main = withBlog $ basicHandler 3000</code></pre>
      </div>
      <h3>Blog, part 2</h3>
      <div>
        <iframe src="http://player.vimeo.com/video/13353654?portrait=0" width="480" height="320" frameborder="0"></iframe><p><a href="http://vimeo.com/13353654">Blog Tutorial - Part 2 - Yesod Web Framework 0.4.0</a> from <a href="http://vimeo.com/user1975429">Michael Snoyman</a> on <a href="http://vimeo.com">Vimeo</a>.</p>
<p>Here's the source code:</p>
<pre><code>
{-# LANGUAGE TypeFamilies, QuasiQuotes, GeneralizedNewtypeDeriving #-}
import Yesod
import Yesod.Helpers.Crud
import Database.Persist.Sqlite
import Data.Time (Day)

share2 mkToForm mkPersist [$persist|
Entry
    title String
    day JqueryDay Desc
    content NicHtml
    deriving
|]

instance Item Entry where
    itemTitle = entryTitle

data Blog = Blog { pool :: Pool Connection }

type EntryCrud = Crud Blog Entry

mkYesod "Blog" [$parseRoutes|
/ RootR GET
/entry/#EntryId EntryR GET
/admin AdminR EntryCrud defaultCrud
|]

instance Yesod Blog where
    approot _ = "http://localhost:3000"

instance YesodPersist Blog where
    type YesodDB Blog = SqliteReader
    runDB db = fmap pool getYesod>gt;>gt;= runSqlite db

getRootR = do
    entries <lt;- runDB $ select [] [EntryDayDesc]
    applyLayoutW $ do
        setTitle $ string "Yesod Blog Tutorial Homepage"
        addBody [$hamlet|
%h1 Archive
%ul
    $forall entries entry
        %li
            %a!href=@EntryR.fst.entry@ $entryTitle.snd.entry$
%p
    %a!href=@AdminR.CrudListR@ Admin
|]

getEntryR entryid = do
    entry <lt;- runDB $ get404 entryid
    applyLayoutW $ do
        setTitle $ string $ entryTitle entry
        addBody [$hamlet|
%h1 $entryTitle.entry$
%h2 $show.unJqueryDay.entryDay.entry$
$unNicHtml.entryContent.entry$
|]

withBlog f = withSqlite "blog.db3" 8 $ \pool ->gt; do
    flip runSqlite pool $ do
        initialize (undefined :: Entry)
    f $ Blog pool

main = withBlog $ basicHandler 3000
</code></pre>
      </div>
    </div>
    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1434510-13']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
  </body>
</html>
